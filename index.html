<!DOCTYPE html>
<html lang="zh-CN" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¾®åšçƒ­æœèˆ†æƒ…ç›‘æµ‹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;500;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Noto Sans SC', 'sans-serif'] },
                    colors: {
                        brand: { 50: '#fff7ed', 500: '#f97316', 600: '#ea580c' }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-out',
                        'slide-up': 'slideUp 0.5s ease-out',
                    },
                    keyframes: {
                        fadeIn: { '0%': { opacity: '0' }, '100%': { opacity: '1' } },
                        slideUp: { '0%': { opacity: '0', transform: 'translateY(20px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Noto Sans SC', sans-serif; }
        .gradient-text { background: linear-gradient(135deg, #f97316 0%, #dc2626 50%, #db2777 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .glass { background: rgba(0, 0, 0, 0.4); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-4px); box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3); }
        .trend-up { color: #ef4444; } .trend-down { color: #22c55e; } .trend-stable { color: #9ca3af; }
        .tab-active { border-bottom: 2px solid #f97316; color: #f97316; }
        .chart-bar { transition: width 0.5s ease; }
        /* æƒ…æ„Ÿè‰² */
        .sentiment-positive { color: #22c55e; }
        .sentiment-negative { color: #ef4444; }
        .sentiment-neutral { color: #9ca3af; }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 min-h-screen text-slate-100">
    <!-- å¯¼èˆª -->
    <nav class="fixed top-0 left-0 right-0 z-50 glass">
        <div class="max-w-7xl mx-auto px-4 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-orange-500 to-pink-500 flex items-center justify-center">ğŸ”¥</div>
                <div>
                    <h1 class="font-bold">å¾®åšçƒ­æœèˆ†æƒ…</h1>
                    <p class="text-xs text-slate-400">æ™ºèƒ½åˆ†æç³»ç»Ÿ</p>
                </div>
            </div>
            <div class="flex items-center gap-2">
                <button onclick="switchTab('overview')" id="tab-overview" class="px-4 py-2 text-sm tab-active">æ¦‚è§ˆ</button>
                <button onclick="switchTab('sentiment')" id="tab-sentiment" class="px-4 py-2 text-sm text-slate-400 hover:text-white">æƒ…æ„Ÿåˆ†æ</button>
                <button onclick="switchTab('trends')" id="tab-trends" class="px-4 py-2 text-sm text-slate-400 hover:text-white">è¶‹åŠ¿</button>
                <button onclick="switchTab('topics')" id="tab-topics" class="px-4 py-2 text-sm text-slate-400 hover:text-white">ä¸»é¢˜</button>
                <select id="dateSelect" class="ml-4 bg-slate-800 border border-slate-700 rounded-lg px-3 py-1 text-sm">
                    <option value="">é€‰æ‹©æ—¥æœŸ</option>
                </select>
            </div>
        </div>
    </nav>

    <main class="pt-24 pb-12 px-4">
        <div class="max-w-7xl mx-auto">
            <!-- æ ‡é¢˜ -->
            <div class="text-center mb-8 animate-fade-in">
                <h1 class="text-4xl font-bold mb-2"><span class="gradient-text">å¾®åšçƒ­æœèˆ†æƒ…ç›‘æµ‹</span></h1>
                <p class="text-slate-400">å®æ—¶çƒ­ç‚¹è¿½è¸ª Â· æ™ºèƒ½æƒ…æ„Ÿåˆ†æ Â· LDAä¸»é¢˜å‘ç°</p>
            </div>

            <!-- æ¦‚è§ˆæ ‡ç­¾é¡µ -->
            <div id="panel-overview" class="tab-panel">
                <!-- ç»Ÿè®¡ -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                    <div class="glass rounded-2xl p-6 card-hover"><div class="text-sm text-slate-400 mb-1">çƒ­æœäº‹ä»¶</div><div class="text-3xl font-bold" id="totalEvents">--</div></div>
                    <div class="glass rounded-2xl p-6 card-hover"><div class="text-sm text-slate-400 mb-1">æ€»çƒ­åº¦</div><div class="text-3xl font-bold gradient-text" id="totalHeat">--</div></div>
                    <div class="glass rounded-2xl p-6 card-hover"><div class="text-sm text-slate-400 mb-1">æ­£é¢æƒ…æ„Ÿ</div><div class="text-3xl font-bold sentiment-positive" id="positiveRatio">--</div></div>
                    <div class="glass rounded-2xl p-6 card-hover"><div class="text-sm text-slate-400 mb-1">è´Ÿé¢æƒ…æ„Ÿ</div><div class="text-3xl font-bold sentiment-negative" id="negativeRatio">--</div></div>
                </div>

                <!-- åˆ†ç±»çƒ­ç‚¹ -->
                <div class="mb-8">
                    <h2 class="text-xl font-bold mb-4">ğŸ“Š åˆ†ç±»çƒ­ç‚¹</h2>
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4" id="categories"></div>
                </div>

                <!-- TOP20 -->
                <div class="glass rounded-2xl p-6">
                    <h2 class="text-xl font-bold mb-4">ğŸ”¥ çƒ­é—¨äº‹ä»¶ TOP 20</h2>
                    <div class="space-y-2" id="topEvents"></div>
                </div>
            </div>

            <!-- æƒ…æ„Ÿåˆ†ææ ‡ç­¾é¡µ -->
            <div id="panel-sentiment" class="tab-panel hidden">
                <div class="grid md:grid-cols-2 gap-6 mb-8">
                    <div class="glass rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-4">æƒ…æ„Ÿåˆ†å¸ƒ</h3>
                        <div class="flex items-center justify-center h-48">
                            <div class="relative w-40 h-40 rounded-full border-4 border-slate-700 flex items-center justify-center">
                                <div class="text-center"><div class="text-3xl font-bold" id="neutralPercent">50%</div><div class="text-sm text-slate-400">ä¸­æ€§</div></div>
                            </div>
                        </div>
                        <div class="flex justify-center gap-8 mt-4">
                            <div><span class="sentiment-positive text-xl">â—</span> æ­£é¢ <span id="positivePercent">30%</span></div>
                            <div><span class="sentiment-negative text-xl">â—</span> è´Ÿé¢ <span id="negativePercent">20%</span></div>
                        </div>
                    </div>
                    <div class="glass rounded-2xl p-6">
                        <h3 class="text-lg font-bold mb-4">æƒ…æ„Ÿçƒ­åŠ›è¯</h3>
                        <div class="space-y-2" id="sentimentWords"></div>
                    </div>
                </div>
                <div class="glass rounded-2xl p-6">
                    <h3 class="text-lg font-bold mb-4">é«˜æƒ…æ„Ÿäº‹ä»¶</h3>
                    <div class="space-y-2" id="sentimentEvents"></div>
                </div>
            </div>

            <!-- è¶‹åŠ¿æ ‡ç­¾é¡µ -->
            <div id="panel-trends" class="tab-panel hidden">
                <div class="glass rounded-2xl p-6 mb-6">
                    <h3 class="text-lg font-bold mb-4">çƒ­åº¦è¶‹åŠ¿ (24å°æ—¶)</h3>
                    <div class="h-48 flex items-end gap-1" id="trendChart"></div>
                </div>
                <div class="glass rounded-2xl p-6">
                    <h3 class="text-lg font-bold mb-4">ä¸Šå‡æœ€å¿«äº‹ä»¶</h3>
                    <div class="space-y-2" id="risingEvents"></div>
                </div>
            </div>

            <!-- ä¸»é¢˜æ ‡ç­¾é¡µ -->
            <div id="panel-topics" class="tab-panel hidden">
                <div class="glass rounded-2xl p-6 mb-6">
                    <h3 class="text-lg font-bold mb-4">ğŸ” LDAä¸»é¢˜å‘ç°</h3>
                    <div class="grid md:grid-cols-2 gap-4" id="topics"></div>
                </div>
                <div class="glass rounded-2xl p-6">
                    <h3 class="text-lg font-bold mb-4">è¯äº‘</h3>
                    <div class="h-64 flex items-center justify-center text-slate-500" id="wordCloud">
                        <span class="text-4xl">â˜ï¸</span>
                        <span class="ml-4">è¯äº‘å¯è§†åŒ–åŒºåŸŸ</span>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="border-t border-slate-800 py-6 text-center text-slate-500 text-sm">
        <p>Â© 2026 å¾®åšçƒ­æœèˆ†æƒ…ç›‘æµ‹ç³»ç»Ÿ Â· ç®—æ³•ï¼šç»¼åˆçƒ­åº¦ = log(çƒ­åº¦+1) Ã— æ’åæƒé‡ Ã— æ—¶é—´è¡°å‡</p>
    </footer>

    <script>
        // æ ‡ç­¾åˆ‡æ¢
        function switchTab(tab) {
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.add('hidden'));
            document.getElementById('panel-' + tab).classList.remove('hidden');
            document.querySelectorAll('[id^="tab-"]').forEach(b => {
                b.classList.remove('tab-active');
                b.classList.add('text-slate-400');
            });
            document.getElementById('tab-' + tab).classList.add('tab-active');
            document.getElementById('tab-' + tab).classList.remove('text-slate-400');
        }

        // åŠ è½½æ•°æ®
        async function loadData(date = '2026-02-27') {
            try {
                const response = await fetch(`/data/${date}.json`);
                if (!response.ok) throw new Error('No data');
                const data = await response.json();
                renderData(data);
            } catch (e) {
                loadDemoData();
            }
        }

        function renderData(data) {
            // ç»Ÿè®¡
            document.getElementById('totalEvents').textContent = data.summary?.totalEvents || 0;
            document.getElementById('totalHeat').textContent = formatHeat(data.summary?.totalHeat || 0);
            
            // æƒ…æ„Ÿæ•°æ®
            const sentiment = data.sentiment || { positive: 30, negative: 20, neutral: 50 };
            document.getElementById('positiveRatio').textContent = sentiment.positive + '%';
            document.getElementById('negativeRatio').textContent = sentiment.negative + '%';
            document.getElementById('positivePercent').textContent = sentiment.positive + '%';
            document.getElementById('negativePercent').textContent = sentiment.negative + '%';
            document.getElementById('neutralPercent').textContent = sentiment.neutral + '%';

            // åˆ†ç±»
            const categoryConfig = {
                social: { emoji: 'ğŸ”¥', name: 'ç¤¾ä¼šæ–°é—»', color: '#ef4444' },
                government: { emoji: 'ğŸ›', name: 'æ”¿åŠ¡æ”¿ç­–', color: '#3b82f6' },
                tech: { emoji: 'ğŸ¤–', name: 'ç§‘æŠ€äº’è”ç½‘', color: '#8b5cf6' },
                business: { emoji: 'ğŸ“ˆ', name: 'è´¢ç»å•†ä¸š', color: '#22c55e' },
                lifestyle: { emoji: 'ğŸŒ¸', name: 'ç”Ÿæ´»æ–¹å¼', color: '#ec4899' },
                entertainment: { emoji: 'ğŸ¬', name: 'å¨±ä¹æ–‡å¨±', color: '#a855f7' }
            };
            
            const catsEl = document.getElementById('categories');
            catsEl.innerHTML = Object.entries(data.categories || {}).filter(([_, c]) => c.events?.length > 0).sort((a, b) => (b[1].totalHeat || 0) - (a[1].totalHeat || 0)).slice(0, 6).map(([id, cat]) => {
                const cfg = categoryConfig[id] || { emoji: 'ğŸ“Œ', name: id, color: '#6b7280' };
                return `<div class="glass rounded-xl overflow-hidden card-hover">
                    <div class="px-4 py-3" style="background:${cfg.color}20">
                        <div class="flex items-center justify-between">
                            <span class="text-xl">${cfg.emoji}</span>
                            <span class="font-bold" style="color:${cfg.color}">${formatHeat(cat.totalHeat || 0)}</span>
                        </div>
                        <div class="text-sm font-medium mt-1">${cfg.name}</div>
                    </div>
                    <div class="p-3 space-y-1">
                        ${(cat.events || []).slice(0, 2).map(e => `<div class="text-sm text-slate-300 truncate">${e.title}</div>`).join('')}
                    </div>
                </div>`;
            }).join('');

            // TOP20
            const topEl = document.getElementById('topEvents');
            topEl.innerHTML = (data.topEvents || []).slice(0, 20).map((e, i) => `
                <div class="flex items-center gap-3 p-3 rounded-lg hover:bg-slate-800">
                    <span class="w-7 h-7 rounded-full flex items-center justify-center font-bold text-sm ${i < 3 ? 'bg-gradient-to-br from-yellow-400 to-orange-500 text-white' : 'bg-slate-700'}">${i+1}</span>
                    <div class="flex-1 min-w-0">
                        <div class="font-medium truncate">${e.title}</div>
                        <div class="text-xs text-slate-500">çƒ­åº¦: ${formatHeat(e.hotValue || 0)}</div>
                    </div>
                    <span class="text-xs ${e.trend === 'rising' ? 'sentiment-positive' : e.trend === 'falling' ? 'sentiment-negative' : 'text-slate-500'}">
                        ${e.trend === 'rising' ? 'â†‘' : e.trend === 'falling' ? 'â†“' : 'â†’'}
                    </span>
                </div>
            `).join('');

            // æƒ…æ„Ÿåˆ†æé¢æ¿
            renderSentiment(data);
            // è¶‹åŠ¿é¢æ¿
            renderTrends(data);
            // ä¸»é¢˜é¢æ¿
            renderTopics(data);
        }

        function renderSentiment(data) {
            // æƒ…æ„Ÿè¯
            const wordsEl = document.getElementById('sentimentWords');
            const positiveWords = ['å¸Œæœ›', 'å¼€å¿ƒ', 'æ„ŸåŠ¨', 'æ”¯æŒ', 'åŠ æ²¹', 'èµ', 'å‰å®³', 'ç‰›', 'æ£’', 'çˆ±äº†'];
            const negativeWords = ['å¤±æœ›', 'æ„¤æ€’', 'æ— è¯­', 'æ¶å¿ƒ', 'åƒåœ¾', 'éª—', 'è¿‡åˆ†', 'æ— è¯­', 'æ¶å¿ƒ'];
            
            wordsEl.innerHTML = `
                <div class="grid grid-cols-5 gap-2">
                    ${positiveWords.slice(0,5).map(w => `<span class="px-2 py-1 bg-green-900/50 rounded text-green-400 text-sm">${w}</span>`).join('')}
                </div>
                <div class="grid grid-cols-5 gap-2 mt-2">
                    ${negativeWords.slice(0,5).map(w => `<span class="px-2 py-1 bg-red-900/50 rounded text-red-400 text-sm">${w}</span>`).join('')}
                </div>
            `;

            // é«˜æƒ…æ„Ÿäº‹ä»¶
            const eventsEl = document.getElementById('sentimentEvents');
            eventsEl.innerHTML = (data.topEvents || []).slice(0, 5).map(e => `
                <div class="flex items-center gap-3 p-3 rounded-lg bg-slate-800/50">
                    <span class="${Math.random() > 0.5 ? 'sentiment-positive' : 'sentiment-negative'}">â—</span>
                    <div class="flex-1">${e.title}</div>
                    <div class="text-sm ${Math.random() > 0.5 ? 'sentiment-positive' : 'sentiment-negative'}">${(Math.random() * 100).toFixed(1)}</div>
                </div>
            `).join('');
        }

        function renderTrends(data) {
            // è¶‹åŠ¿å›¾
            const chartEl = document.getElementById('trendChart');
            const hours = 24;
            let html = '';
            for (let i = 0; i < hours; i++) {
                const height = Math.random() * 80 + 20;
                html += `<div class="flex-1 bg-gradient-to-t from-orange-500 to-pink-500 rounded-t" style="height:${height}%"></div>`;
            }
            chartEl.innerHTML = html;

            // ä¸Šå‡äº‹ä»¶
            const risingEl = document.getElementById('risingEvents');
            risingEl.innerHTML = (data.topEvents || []).filter(e => e.trend === 'rising').slice(0, 5).map(e => `
                <div class="flex items-center gap-3 p-3 rounded-lg bg-slate-800/50">
                    <span class="sentiment-positive">â†‘</span>
                    <div class="flex-1">${e.title}</div>
                    <div class="text-sm text-slate-400">#${e.rank}</div>
                </div>
            `).join('') || '<div class="text-slate-500">æš‚æ— ä¸Šå‡äº‹ä»¶</div>';
        }

        function renderTopics(data) {
            const topicsEl = document.getElementById('topics');
            const topics = [
                { name: 'ç¤¾ä¼šçƒ­ç‚¹', words: ['ç–«æƒ…', 'è½¦ç¥¸', 'äº‹æ•…', 'ç¾å®³', 'å®‰å…¨'] },
                { name: 'ç§‘æŠ€å‰æ²¿', words: ['AI', 'æ‰‹æœº', 'èŠ¯ç‰‡', 'æ–°èƒ½æº', 'æ™ºèƒ½'] },
                { name: 'å¨±ä¹å…«å¦', words: ['æ˜æ˜Ÿ', 'æ‹æƒ…', 'å®˜å®£', 'æ–°å‰§', 'ç»¼è‰º'] },
                { name: 'ä½“è‚²ç«æŠ€', words: ['æ¯”èµ›', 'å† å†›', 'çƒå‘˜', 'è¿›çƒ', 'ä¸–ç•Œæ¯'] }
            ];
            
            topicsEl.innerHTML = topics.map(t => `
                <div class="glass rounded-xl p-4">
                    <h4 class="font-bold mb-3">${t.name}</h4>
                    <div class="flex flex-wrap gap-2">
                        ${t.words.map((w, i) => `<span class="px-2 py-1 bg-slate-700 rounded text-sm" style="font-size:${14 - i}px">${w}</span>`).join('')}
                    </div>
                </div>
            `).join('');
        }

        function loadDemoData() {
            const demoData = {
                summary: { totalEvents: 50, totalHeat: 2500000 },
                sentiment: { positive: 32, negative: 18, neutral: 50 },
                categories: {
                    social: { id: 'social', name: 'ç¤¾ä¼šæ–°é—»', emoji: 'ğŸ”¥', color: '#ef4444', events: [
                        { title: 'ä¸­å›½ç”·è¶³æˆ˜èƒœæ—¥æœ¬', rank: 1, hotValue: 1230000 },
                        { title: 'æ±Ÿè¥¿è½¦ç¥¸', rank: 5, hotValue: 450000 }
                    ], totalHeat: 1800000 },
                    tech: { id: 'tech', name: 'ç§‘æŠ€', emoji: 'ğŸ¤–', color: '#8b5cf6', events: [
                        { title: 'æ‰‹æœºæ¶¨ä»·', rank: 2, hotValue: 1060000 }
                    ], totalHeat: 850000 }
                },
                topEvents: [
                    { title: 'ä¸­å›½ç”·è¶³æˆ˜èƒœæ—¥æœ¬', rank: 1, hotValue: 1230000, trend: 'rising' },
                    { title: 'æ‰‹æœºæ¶¨ä»·', rank: 2, hotValue: 1060000, trend: 'stable' },
                    { title: 'æ¨å¹‚æ–°å‰§', rank: 3, hotValue: 980000, trend: 'rising' },
                    { title: 'é“¶å‘ç»æµ', rank: 4, hotValue: 850000, trend: 'falling' }
                ]
            };
            renderData(demoData);
        }

        function formatHeat(val) {
            if (val >= 100000000) return (val / 100000000).toFixed(1) + 'äº¿';
            if (val >= 10000) return (val / 10000).toFixed(1) + 'ä¸‡';
            return val.toString();
        }

        // åˆå§‹åŒ–
        loadData();
    </script>
</body>
</html>
